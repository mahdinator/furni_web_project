<%- include('partials/header') %> 
<%- include('partials/navbar') %>

<!-- JS logic for adding to cart -->
<script src="/js/shoplogic.js"></script>

<!-- Hero Section -->
<div class="hero">
  <div class="container">
    <div class="row justify-content-between">
      <div class="col-lg-5">
        <div class="intro-excerpt">
          <h1>Shop</h1>
          <p class="lead">Discover our collection of modern, high-quality furniture designed for comfort and style.</p>
        </div>
      </div>
      <div class="col-lg-7"></div>
    </div>
  </div>
</div>

<!-- Product Section -->
<div class="untree_co-section product-section before-footer-section">
  <div class="container">
    <div class="row">
      <!--filter start-->
      <div class="row mb-4 align-items-end">

        <div class="col-md-3">
          <label for="search" class="form-label">Search</label>
          <input type="text" id="search" class="form-control" placeholder="Search products..." value="<%= query || '' %>">
        </div>

        <div class="col-md-3">
          <label for="category" class="form-label">Category</label>
          <select id="category" class="form-select">
            <option value="" <%= !category ? "selected" : "" %>>All</option>
            <option value="Chair" <%= category === "Chair" ? "selected" : "" %>>Chair</option>
            <option value="Table" <%= category === "Table" ? "selected" : "" %>>Table</option>
            <option value="Sofa" <%= category === "Sofa" ? "selected" : "" %>>Sofa</option>
            <option value="Bed" <%= category === "Bed" ? "selected" : "" %>>Bed</option>
            <option value="Cabinet" <%= category === "Cabinet" ? "selected" : "" %>>Cabinet</option>
          </select>
        </div>

        <div class="col-md-2">
          <label for="price-min" class="form-label">Min Price ($)</label>
          <input type="range" id="price-min" class="form-range" min="1" max="5000" value="<%= min || 1 %>">
          <input type="number" id="price-min-value" class="form-control mt-2" min="1" max="5000" value="<%= min || 1 %>">
        </div>

        <div class="col-md-2">
          <label for="price-max" class="form-label">Max Price ($)</label>
          <input type="range" id="price-max" class="form-range" min="0" max="5000" value="<%= max || 5000 %>">
          <input type="number" id="price-max-value" class="form-control mt-2" min="0" max="5000" value="<%= max || 5000 %>">
        </div>

        <div class="col-md-2 d-flex justify-content-end">
          <button id="search-btn" class="btn btn-dark w-100">Search</button>
        </div>
      </div>


      <!--filter end-->


      <!-- Product grid start -->
      <% if (products && products.length > 0) { %>
        <% products.forEach(p => { %>
          <div class="col-12 col-md-4 col-lg-3 mb-5">
            <div class="product-item shadow-sm rounded-3 p-2 text-center position-relative">
              <a href="/product/<%= p.id %>">
                <img src="/images/<%= p.image || 'default.jpg' %>" class="img-fluid product-thumbnail mb-3 rounded-3" alt="<%= p.name %>" />
              </a>
              <h5 class="product-title mb-1"><%= p.name %></h5>
              <p class="text-muted small"><%= p.description || '' %></p>
              <strong class="product-price d-block mb-3">$<%= p.price %></strong>
              
              <!-- Add to cart icon -->
              <button class="icon-cross" data-id="<%= p.id %>" title="Add to cart">
                <img src="/images/cross.svg" class="img-fluid" style="width: 16px; height: 16px;" />
              </button>
            </div>
          </div>
        <% }) %>
      <% } else { %>
        <div class="text-center mt-5">
          <h4>No products found ðŸ˜•</h4>
        </div>
      <% } %>
      <!-- Product grid end -->
    </div>
  </div>
</div>

<!-- products end-->
<%- include('partials/footer') %>